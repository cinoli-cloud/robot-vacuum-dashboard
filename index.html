<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robot Vacuum Competitive Intelligence Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header -->
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-robot"></i> Robot Vacuum Market Intelligence
            </a>
            <div class="d-flex align-items-center">
                <span class="text-light me-3" id="lastUpdate">Last Update: Loading...</span>
                <button class="btn btn-outline-light btn-sm" onclick="manualUpdate()">
                    <i class="bi bi-arrow-clockwise"></i> Manual Update
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container-fluid py-4">

        <!-- Tabs for Different Views (At Top) -->
        <ul class="nav nav-tabs mb-3" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="price-tab" data-bs-toggle="tab" data-bs-target="#price-comparison" type="button" role="tab" onclick="switchTab('price')">
                    <i class="bi bi-currency-dollar"></i> Price Comparison
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="trend-tab" data-bs-toggle="tab" data-bs-target="#price-trends" type="button" role="tab" onclick="switchTab('trends')">
                    <i class="bi bi-graph-up"></i> Price Trends
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="news-tab" data-bs-toggle="tab" data-bs-target="#news" type="button" role="tab" onclick="switchTab('news')">
                    <i class="bi bi-newspaper"></i> Latest News
                </button>
            </li>
        </ul>

        <!-- Brand Filter Buttons -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="btn-group" role="group" id="brandFilterButtons">
                    <button type="button" class="btn btn-outline-primary active" onclick="filterBrand('all')">All Brands</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Eufy')">Eufy</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Roborock')">Roborock</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Dreame')">Dreame</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Ecovacs')">Ecovacs</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Shark')">Shark</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Narwal')">Narwal</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('Dyson')">Dyson</button>
                    <button type="button" class="btn btn-outline-primary" onclick="filterBrand('iRobot')">iRobot</button>
                </div>
            </div>
        </div>

        <!-- Summary Cards - Dynamic by Brand and Tab -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card text-white bg-success">
                    <div class="card-body">
                        <h5 class="card-title" id="cardTitle1">Total Products</h5>
                        <h2 class="card-text" id="totalProducts">-</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-white bg-warning">
                    <div class="card-body">
                        <h5 class="card-title" id="cardTitle2">Price Changes (24h)</h5>
                        <h2 class="card-text" id="priceChanges">-</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-white bg-info">
                    <div class="card-body">
                        <h5 class="card-title">Average Price</h5>
                        <h2 class="card-text" id="avgPrice">-</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-white bg-danger">
                    <div class="card-body">
                        <h5 class="card-title">Lowest Price</h5>
                        <h2 class="card-text" id="lowestPrice">-</h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content -->

        <!-- Tab Content -->
        <div class="tab-content" id="mainTabsContent">

            <!-- Price Comparison Tab -->
            <div class="tab-pane fade show active" id="price-comparison" role="tabpanel">
                <!-- Price Comparison Table -->
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="priceTable">
                                <thead>
                                    <tr>
                                        <th>Brand</th>
                                        <th>Product</th>
                                        <th>MSRP</th>
                                        <th>Official Site</th>
                                        <th>Best Buy</th>
                                        <th>Walmart</th>
                                        <th>Costco</th>
                                        <th>eBay</th>
                                    </tr>
                                </thead>
                                <tbody id="priceTableBody">
                                    <tr>
                                        <td colspan="8" class="text-center">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Price Trends Tab -->
            <div class="tab-pane fade" id="price-trends" role="tabpanel">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5>Price Trend - Last 30 Days</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="priceTrendChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5>Brand Average Price Comparison</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="brandComparisonChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5>Price Forecast (Next 7 Days)</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="priceForecastChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- News Tab -->
            <div class="tab-pane fade" id="news" role="tabpanel">
                <div class="row" id="newsContainer">
                    <!-- News cards will be dynamically inserted here -->
                    <div class="col-12 text-center">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading news...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-5">
        <p class="mb-0">Robot Vacuum Market Intelligence Dashboard | Data updated daily at 8:00 AM | <span id="dataSource">Data sources: Official websites, Amazon, Walmart, Costco, eBay</span></p>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
